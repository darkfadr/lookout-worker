<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <!-- environment variables for app -->
  <appSettings>
    <add key="ALIAS" value="" />
    <add key="RABBIT_HOST" value="FL1CDISDAP01" />
    <add key="RABBIT_USER" value="user" />
    <add key="RABBIT_PASSWORD" value="user" />
  </appSettings>
  <system.webServer>
    <!-- mimeMap enables IIS to serve particular file types as specified by fileExtension. -->
    <staticContent>
      <!-- <mimeMap fileExtension=".svg" mimeType="image/svg+xml" /> -->
      <remove fileExtension=".eot" />
      <remove fileExtension=".otf" />
      <remove fileExtension=".svg" />
      <remove fileExtension=".ttf" />
      <remove fileExtension=".woff" />
      <mimeMap fileExtension=".otf" mimeType="font/otf" />
      <mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
      <mimeMap fileExtension=".ttf" mimeType="application/font-sfnt" />
      <mimeMap fileExtension=".woff" mimeType="application/x-font-woff" />
    </staticContent>
    <modules runAllManagedModulesForAllRequests="false" />
    <iisnode configOverrides="iisnode.yml"
      watchedFiles="web.config;*.js;"
      nodeProcessCommandLine="C:\Program Files\nodejs\node.exe" />
    <handlers>
      <!-- Handler for non Socket.io Apps -->
      <add name="iisnode" path="index.js" verb="*" modules="iisnode" />
    </handlers>

  <httpProtocol>
    <customHeaders>
      <remove name="X-Powered-By" />
      <remove name="Server" />
      <!-- <add name="Access-Control-Allow-Origin" value="*" /> -->
      <add name="Access-Control-Allow-Methods" value="POST, PUT, DELETE, GET, OPTIONS" />
      <add name="Access-Control-Allow-Headers" value="content-Type, accept, origin, X-Requested-With, Authorization, name" />
    </customHeaders>
  </httpProtocol>

   <rewrite>
     <rules>
       <rule name="node.js">
         <match url="/*" />
         <action type="Rewrite" url="index.js" />
       </rule>
     </rules>
     <!-- TODO: configure for CORS -->
     <!-- <outboundRules>
         <clear />
         <rule name="AddCrossDomainHeader">
             <match serverVariable="RESPONSE_Access_Control_Allow_Origin" pattern=".*" />
             <conditions logicalGrouping="MatchAll" trackAllCaptures="true">
                 <add input="{HTTP_ORIGIN}" pattern="(http(s)?:\/\/((.+\.)?(fl1cdisdwb01:3333||localhost:4200|dev.io:4200)\.(com|org|net)))" />
             </conditions>
             <action type="Rewrite" value="{C:0}" />
         </rule>
     </outboundRules> -->

   </rewrite>

    <security>
      <requestFiltering>
        <hiddenSegments>
          <add segment="node_modules" />
        </hiddenSegments>
      </requestFiltering>
    </security>
    <directoryBrowse enabled="false" />
  </system.webServer>
</configuration>
